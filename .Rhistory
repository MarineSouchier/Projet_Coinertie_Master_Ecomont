library(tidyverse)
library(corrplot)
library(ade4)
library(kableExtra)
library(knitr)
library(splines)
library(plotly)
library(DT)
library(Hmisc)
library(FactoMineR)
library(factoextra)
setwd(".")
spe <- read.csv2('Especes2.csv', row.names = 1)
spe
setwd(".")
env <- read.csv2('Abiotique3.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=5)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
inertia.dudi(coa1)
fviz_screeplot (coa1) +
geom_hline (yintercept = 12.5962292, linetype = 2, color = "red")
which(is.na(env),arr.ind=TRUE)
env2 <- env
env2[is.na(env2)] <- mean(env$Teneur_eau, na.rm = T)
dudienv<-dudi.hillsmith(env2, scannf = FALSE, nf = 2, row.w=coa1$lw)
scatter(dudienv)
par(mfrow=c(2,1))
s.label(dudienv$co, clabel=0.7)
s.label(dudienv$li, clabel=0.7)
acp1<-dudi.pca(env,scannf=F, scale=T, center=T, nf=2)
acp1<-dudi.pca(env,scannf=F, scale=T, center=T, nf=2)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=2)
coiner<-coinertia(coa1, acp1, scannf = F, nf = 2)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=2, row.w=coa1$lw)
coiner<-coinertia(coa1, acp1, scannf = F, nf = 2)
randtest(coiner)
plot(coiner)
par(mfrow=c(2,1))
s.label(coiner$c1)
s.label(coiner$l1)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=2, row.w=coa1$lw)
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
randtest(coiner)
library(tidyverse)
library(corrplot)
library(ade4)
library(kableExtra)
library(knitr)
library(splines)
library(plotly)
library(DT)
library(Hmisc)
library(FactoMineR)
library(factoextra)
setwd(".")
spe <- read.csv2('Especes2.csv', row.names = 1)
spe
setwd(".")
env <- read.csv2('Abiotique3.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
inertia.dudi(coa1)
fviz_screeplot (coa1) +
geom_hline (yintercept = 12.5962292, linetype = 2, color = "red")
which(is.na(env),arr.ind=TRUE)
env2 <- env
env2[is.na(env2)] <- mean(env$Teneur_eau, na.rm = T)
dudienv<-dudi.hillsmith(env2, scannf = FALSE, nf = 2, row.w=coa1$lw)
scatter(dudienv)
par(mfrow=c(2,1))
s.label(dudienv$co, clabel=0.7)
s.label(dudienv$li, clabel=0.7)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=2, row.w=coa1$lw)
plot(dudienv$eig, type = "b")
inertia.dudi(dudienv)
coiner<-coinertia(coa1, acp1, scannf = F, nf = 2)
plot(coiner)
par(mfrow=c(2,1))
s.label(coiner$c1)
s.label(coiner$l1)
randtest(coiner)
plot(randtest(coiner))
install.packages("vegan")
summary(coiner)
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
coa1$eig
get_eigenvalue(coa1)
Rv.test(coiner)
install.packages("digitTests")
library(digitTests)
Rv.test(coiner)
?rv.test
rv.test(coiner)
rv.test(coiner)
?randtest
randtest(coiner, fixed=1)
plot(randtest(coiner, fixed=1))
######################################################################################################################################
#Cours Novembre: coinertie et RLQ sur le jeu de donnees ARAVO
library(ade4)
#Chargement donnees
data("aravo")
?aravo
#1. AFC
#AFC sur absence/presence especes
coa1 <-dudi.coa(aravo$spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
aravo$spe.names
#Interpretation:
#Plutot une gradiation des especes
#Si besoin de voir etiquettes cachees, copie/colle sur power point et on retire les etiquettes pour identifier etiquettes cachees
#2. Multivariate analysis with mixed quantitative variables and factors
#Travail sur df env : jeu de donnees tres diversifie (variable quantitative, factorielle, etc)=> utilisation dudi.hillssmith
?dudi.hillsmith
dudienv<-dudi.hillsmith(aravo$env, scannf = FALSE, nf = 2, row.w=coa1$lw)
dudienv$li
#row.w = coa1$lw pour imposer que poids des axes dans l'analyse multivariee mixte pour l'etude de coinertie = poids des axes AFC
#poids des axes = variabilite du jeu de donnees expliquee par les axes
par(mfrow=c(2,1))
s.label(dudienv$co, clabel=0.7)
s.label(dudienv$li, clabel=0.7)
#En bas => cretes ventees
#A gauche => combes a neige
#A drote => milieux de pente
#3. Coinertie
#Il faut que poids des axes soit similaires entre AFC et ACP mixte (pas besoin si coinertie entre 2 ACP car maintien dans un cercle de correlation par defaut avec echelle similaire meme si donnees pas centrees normees)
coiner<-coinertia(coa1, dudienv)
rlq1<-rlq(dudienv, coa1, duditrait, scannf= FALSE, nf=2)
#Construction ACP des traits fonctionnels
duditrait<-dudi.pca(aravo$traits, scannf = FALSE, nf=2, row.w=coa1$cw)
s.corcircle(duditrait$co, clabel=0.5)  #s.corcicle pour avoir le cercle de correlation en plus
s.label(duditrait$li, clabel=0.5)
rlq1<-rlq(dudienv, coa1, duditrait, scannf= FALSE, nf=2)
s.label(rlq1$c1)
s.label(rlq1$l1)
plot(rlq1)
randtest(rlq1)
plot(randtest(rlq1))
randtest(coiner, fixed=1)
library(tidyverse)
library(corrplot)
library(ade4)
library(kableExtra)
library(knitr)
library(splines)
library(plotly)
library(DT)
library(Hmisc)
library(FactoMineR)
library(factoextra)
library(digitTests)
setwd(".")
spe <- read.csv2('Especes2.csv', row.names = 1)
spe
setwd(".")
env <- read.csv2('Abiotique3.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
inertia.dudi(coa1)
fviz_screeplot (coa1) +
geom_hline (yintercept = 12.5962292, linetype = 2, color = "red")
get_eigenvalue(coa1)
which(is.na(env),arr.ind=TRUE)
env2 <- env
env2[is.na(env2)] <- mean(env$Teneur_eau, na.rm = T)
dudienv<-dudi.hillsmith(env2, scannf = FALSE, nf = 2, row.w=coa1$lw)
scatter(dudienv)
par(mfrow=c(2,1))
s.label(dudienv$co, clabel=0.7)
s.label(dudienv$li, clabel=0.7)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=2, row.w=coa1$lw)
plot(dudienv$eig, type = "b")
inertia.dudi(dudienv)
coiner<-coinertia(coa1, dudienv, scannf = F, nf = 2)
plot(coiner)
par(mfrow=c(2,1))
s.label(coiner$c1)
s.label(coiner$l1)
randtest(coiner)
randtest(coiner, fixed=1)
plot(randtest(coiner))
randtest(coiner)
plot(coiner)
par(mfrow=c(2,1))
s.label(coiner$c1)
s.label(coiner$l1)
randtest(coiner, fixed=1)
randtest(coiner, fixed=1)
plot(randtest(coiner, fixed=1))
library(tidyverse)
library(corrplot)
library(ade4)
library(kableExtra)
library(knitr)
library(splines)
library(plotly)
library(DT)
library(Hmisc)
library(FactoMineR)
library(factoextra)
library(digitTests)
setwd(".")
spe <- read.csv2('Especes2.csv', row.names = 1)
spe
setwd(".")
env <- read.csv2('Abiotique3.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
inertia.dudi(coa1)
fviz_screeplot (coa1) +
geom_hline (yintercept = 12.5962292, linetype = 2, color = "red")
get_eigenvalue(coa1)
which(is.na(env),arr.ind=TRUE)
env2 <- env
env2[is.na(env2)] <- mean(env$Teneur_eau, na.rm = T)
dudienv<-dudi.hillsmith(env2, scannf = FALSE, nf = 2, row.w=coa1$lw)
scatter(dudienv)
par(mfrow=c(2,1))
s.label(dudienv$co, clabel=0.7)
s.label(dudienv$li, clabel=0.7)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=2, row.w=coa1$lw)
plot(dudienv$eig, type = "b")
inertia.dudi(dudienv)
library(tidyverse)
library(corrplot)
library(ade4)
library(kableExtra)
library(knitr)
library(splines)
library(plotly)
library(DT)
library(Hmisc)
library(FactoMineR)
library(factoextra)
library(digitTests)
setwd(".")
spe <- read.csv2('Especes2.csv', row.names = 1)
spe
setwd(".")
env <- read.csv2('Abiotique3.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
inertia.dudi(coa1)
fviz_screeplot (coa1) +
geom_hline (yintercept = 12.5962292, linetype = 2, color = "red")
get_eigenvalue(coa1)
which(is.na(env),arr.ind=TRUE)
env2 <- env
env2[is.na(env2)] <- mean(env$Teneur_eau, na.rm = T)
dudienv<-dudi.hillsmith(env2, scannf = FALSE, nf = 2, row.w=coa1$lw)
scatter(dudienv)
par(mfrow=c(2,1))
s.label(dudienv$co, clabel=0.7)
s.label(dudienv$li, clabel=0.7)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=2, row.w=coa1$lw)
plot(dudienv$eig, type = "b")
inertia.dudi(dudienv)
coiner<-coinertia(coa1, dudienv, scannf = F, nf = 2)
plot(coiner)
par(mfrow=c(2,1))
s.label(coiner$c1)
s.label(coiner$l1)
randtest(coiner, fixed=1)
randtest(coiner, fixed=1)
plot(coiner$eig, type = "b")
inertia.dudi(coiner)
summary(coiner)
randtest(coiner, fixed=1)
plot(coiner$eig, type = "b")
inertia.dudi(coiner)
summary(coiner)
randtest(coiner, fixed=1)
coiner<-coinertia(coa1, acp1, scannf = F, nf = 2)
randtest(coiner, fixed=1)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=2, row.w=coa1$lw)
par(mfrow=c(2,1))
s.corcircle(acp1$co)
s.label(acp1$li)
plot(dudienv$eig, type = "b")
inertia.dudi(dudienv)
plot(acp1$eig, type = "b")
inertia.dudi(acp1)
plot(acp1$eig, type = "b")
inertia.dudi(acp1)
coiner<-coinertia(coa1, acp1, scannf = F, nf = 2)
plot(coiner)
par(mfrow=c(2,1))
s.label(coiner$c1)
s.label(coiner$l1)
plot(coiner$eig, type = "b")
inertia.dudi(coiner)
summary(coiner)
randtest(coiner, fixed=1)
plot(randtest(coiner, fixed=1))
inertia.dudi(coiner)
randtest(coiner, fixed=1)
plot(randtest(coiner, fixed=1))
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=5, row.w=coa1$lw)
par(mfrow=c(2,1))
s.corcircle(acp1$co)
s.label(acp1$li)
coiner<-coinertia(coa1, acp1, scannf = F, nf = 2)
coiner<-coinertia(coa1, acp1, scannf = F, nf = 2)
plot(coiner)
par(mfrow=c(2,1))
s.label(coiner$c1)
s.label(coiner$l1)
randtest(coiner, fixed=1)
plot(randtest(coiner, fixed=1))
plot(randtest(coiner, fixed=1, greater))
?randtest
plot(randtest(coiner, fixed=1, alter=c("greater"))
plot(randtest(coiner, fixed=1, alter=c("greater"))
plot(randtest(coiner, fixed=1, alter=c("less"))
randtest(coiner, fixed=1)
plot(randtest(coiner, fixed=1, alter="less")
plot(randtest(coiner, fixed=1, alter="less"))
plot(randtest(coiner, fixed=1, alter=less))
plot(randtest(coiner, fixed=1))
randtest(coiner, fixed=1)
plot(randtest(coiner, fixed=1))
View(env)
head(inertia.dudi(coa1))
stressplot(ACP)
stressplot(coa1)
library(vegan)
?stressplot
stressplot(coa1)
library(RVAideMemoire)
install.packages("RVAideMemoire")
library(RVAideMemoire)
stressplot(coa1)
MVA.synt(coa1)
stressplot(coa1)
coa2<-cca(spe)
View(acp1)
View(spe)
View(spe)
setwd(".")
spe <- read.csv2('Especes3.csv', row.names = 1)
setwd(".")
env <- read.csv2('Abiotique4.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
coa2<-cca(spe)
stressplot(coa2)
library(tidyverse)
library(corrplot)
library(ade4)
library(kableExtra)
library(knitr)
library(splines)
library(DT)
library(Hmisc)
library(FactoMineR)
library(factoextra)
library(vegan)
library(RVAideMemoire)
setwd(".")
spe <- read.csv2('Especes3.csv', row.names = 1)
spe
setwd(".")
env <- read.csv2('Abiotique4.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
coa2<-cca(spe)
stressplot(coa2)
fviz_screeplot (coa1) +
geom_hline (yintercept = 12.5962292, linetype = 2, color = "red")
get_eigenvalue(coa1)
which(is.na(env),arr.ind=TRUE)
which(is.na(env),arr.ind=TRUE)
env2 <- env
env2[is.na(env2)] <- mean(env$Teneur_eau, na.rm = T)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=5, row.w=coa1$lw)
par(mfrow=c(2,1))
s.corcircle(acp1$co)
s.label(acp1$li)
plot(acp1$eig, type = "b")
inertia.dudi(acp1)
coiner<-coinertia(coa1, acp1, scannf = F, nf = 2)
plot(coiner)
par(mfrow=c(2,1))
s.label(coiner$c1)
s.label(coiner$l1)
randtest(coiner, fixed=1)
plot(randtest(coiner, fixed=1))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
plot(env$aspect, env$Teneur_eau)
plot(env2$aspect, env2$Teneur_eau)
plot(env2$aspect, env2$Teneur_eau)
library(tidyverse)
library(corrplot)
library(ade4)
library(kableExtra)
library(knitr)
library(splines)
library(DT)
library(Hmisc)
library(FactoMineR)
library(factoextra)
library(vegan)
library(RVAideMemoire)
setwd(".")
spe <- read.csv2('Especes2.csv', row.names = 1)
spe
setwd(".")
env <- read.csv2('Abiotique3.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
head(inertia.dudi(coa1))
fviz_screeplot (coa1) +
geom_hline (yintercept = 12.5962292, linetype = 2, color = "red")
get_eigenvalue(coa1)
which(is.na(env),arr.ind=TRUE)
env2 <- env
env2[is.na(env2)] <- mean(env$Teneur_eau, na.rm = T)
acp1<-dudi.pca(env2,scannf=F, scale=T, center=T, nf=5, row.w=coa1$lw)
par(mfrow=c(2,1))
s.corcircle(acp1$co)
s.label(acp1$li)
plot(env2$aspect, env2$Teneur_eau)
plot(env2$aspect, env2$Teneur_eau)
View(env2)
plot(env2$aspect, env2$Teneur_eau)
length(env2$Aspect)
plot(env2$Aspect, env2$Teneur_eau)
plot1<-plot(env2$Aspect, env2$Teneur_eau)
abline(plot1)
plot1 <- ggplot(env2, aes(x=Aspect, y=Teneur_eau)) +
geom_point(color="blue", fill=rgb(0.1,0.4,0.5,0.7)) +
labs(title = "Fécondité totale en fonction du poids",x="Poids (kg)", y="Fécondité totale")+
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth()
plot1
plot1 <- ggplot(env2, aes(x=Teneur_eau, y=Aspect)) +
geom_point(color="blue", fill=rgb(0.1,0.4,0.5,0.7)) +
labs(title = "Fécondité totale en fonction du poids",x="Poids (kg)", y="Fécondité totale")+
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth()
plot1
plot1<-plot(env2$Aspect, env2$Teneur_eau)
abline(plot1)
head(inertia.dudi(acp1))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
setwd(".")
spe <- read.csv2('Especes2.csv', row.names = 1)
spe
head(inertia.dudi(coa1))
library(tidyverse)
library(corrplot)
library(ade4)
library(kableExtra)
library(knitr)
library(splines)
library(DT)
library(Hmisc)
library(FactoMineR)
library(factoextra)
library(vegan)
library(RVAideMemoire)
setwd(".")
spe <- read.csv2('Especes2.csv', row.names = 1)
spe
setwd(".")
env <- read.csv2('Abiotique3.csv', dec = ".", row.names = 1)
datatable(env, rownames = TRUE, filter="top", options = list(pageLength = 5, scrollX=T))
coa1 <-dudi.coa(spe, scannf=FALSE, nf=2)
par(mfrow=c(2,1))
s.label(coa1$co, clabel=0.7)
s.label(coa1$li, clabel=0.7)
head(inertia.dudi(coa1))
head(inertia.dudi(coa1))
inertia.dudi(coa1)
fviz_screeplot (coa1)
